<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/template.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/appbar.css') }}">
    {% block rightHeader %}{% endblock %}
</head>
<body>
{% include 'partials/appbar.html' %}
<div class="container">
    {% block content %}
    {% endblock %}
</div>

<script>
    function updateCartCount() {
        const cartItems = JSON.parse(localStorage.getItem('carts')) || [];
        const count = cartItems.length; // counts each item once
        const countElement = document.getElementById('cart-count');
        if (countElement) {
            countElement.textContent = count;
        }
    }

    // Call on page load
    updateCartCount();

    // Re-run on history navigation (back/forward buttons)
    window.addEventListener('popstate', updateCartCount);

    // Re-run if using hash navigation
    window.addEventListener('hashchange', updateCartCount);
</script>
</body>
</html>
